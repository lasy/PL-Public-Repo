glm_cl = glm(
is_first_preg_a_PL ~ avg_cycle_length_4 +
median_cycle_length_4 +
sd_cycle_length_4,
data = u,
family = "binomial")
summary(glm_cl)
glm_cl = glm(
is_first_preg_a_PL ~ median_cycle_length_4,
data = u,
family = "binomial")
summary(glm_cl)
glm_cl = glm(
is_first_preg_a_PL ~ sd_cycle_length_4,
data = u,
family = "binomial")
summary(glm_cl)
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4,
data = u,
family = "binomial")
summary(glm_cl)
ggplot(u, aes(x = avg_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = log(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = avg_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = log(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1)
ggplot(u, aes(x = avg_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = log(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1)
ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1)
ggplot(u, aes(x = avg_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1)
ggplot(u, aes(x = log(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1)
ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1)+xlim(c(0,100))
ggplot(u, aes(x = avg_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1) + xlim(c(0,100))
ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1) + xlim(c(0,100))
ggplot(u, aes(x = log(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1)
ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1) + xlim(c(0,100))
ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1) + xlim(c(0,50))
ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 1) + xlim(c(0,50))
ggplot(u, aes(x = log(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.5)
ggplot(u, aes(x = log10(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.5)
ggplot(u, aes(x = log10(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(col = NA, alpha = 0.5, position = "identity", binwidth = 0.1)
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4,
data = u,
family = "binomial")
summary(glm_cl)
load(file = paste0(IO$output_data,"users.Rdata"), verbose = TRUE)
u$is_first_preg_a_PL = (u$first_preg_outcome_simple == "PL")
u = users[which(!is.na(users$first_preg_outcome_simple)),]
dim(u)
u = users[which(!is.na(users$first_preg_outcome_simple)),]
u$is_first_preg_a_PL = (u$first_preg_outcome_simple == "PL")
u$is_first_preg_a_PL = ifelse(u$first_preg_outcome_simple == "PL","Yes","No")
dim(u)
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4,
data = u,
family = "binomial")
u = users[which(!is.na(users$first_preg_outcome_simple)),]
u$is_first_preg_a_PL = (u$first_preg_outcome_simple == "PL")
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4,
data = u,
family = "binomial")
summary(glm_cl)
u$is_first_preg_a_PL = ifelse(u$is_first_preg_a_PL,"Yes","No")
g = ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.5, position = "identity", binwidth = 1)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(14,70))+
scale_fill_manual(name = "experienced any preg. loss", values = c("blue","red"))+
xlab("median cycle length before first positive preg. test")+
theme(legend.position = "top")
g
g = ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.5, position = "identity", binwidth = 1)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(14,70))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("median cycle length before first positive preg. test")+
theme(legend.position = "top")
g
g = ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.5, position = "identity", binwidth = 0.5)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(0,42))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("standard deviation in cycle length before 1st pos. preg. test")+
theme(legend.position = "top")
g
g = ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(14,70))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("median cycle length before first positive preg. test")+
theme(legend.position = "top")
g
g = ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 0.5)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(0,42))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("standard deviation in cycle length before 1st pos. preg. test")+
theme(legend.position = "top")
g
qqplot(x=  u$median_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$median_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,50), ylim = c(0,50))
abline(a = 0, b = 1)
qqplot(x=  u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,50), ylim = c(0,50))
abline(a = 0, b = 1)
qqplot(x=  u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42))
abline(a = 0, b = 1)
qqplot(x=  u$median_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$median_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,50), ylim = c(0,50))
abline(a = 0, b = 1)
qqplot(x=  u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42))
abline(a = 0, b = 1)
qqplot(x=  u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42),
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
qqplot(x=  u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42),
main = "cycle length variability",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
qqplot(x=  log10(u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")]),
y = log10(u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")]),
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42),
main = "cycle length variability",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
load(file = paste0(IO$output_data,"users.Rdata"), verbose = TRUE)
users$any_PL = ifelse(users$n_PL>0, "Yes", ifelse(users$n_LB>0,"No",NA))
u = users[which(!is.na(users$first_preg_outcome_simple)),]
u$is_first_preg_a_PL = (u$first_preg_outcome_simple == "PL")
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4,
data = u,
family = "binomial")
summary(glm_cl)
u$is_first_preg_a_PL = ifelse(u$is_first_preg_a_PL,"Yes","No")
g = ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(14,70))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("median cycle length before first positive preg. test")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "median_cycle_length_before_first_preg.pdf"), g, width = 5, height = 5)
g = ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 0.5)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(0,42))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("standard deviation in cycle length before 1st pos. preg. test")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "sd_cycle_length_before_first_preg.pdf"), g, width = 5, height = 5)
qqplot(x=  u$median_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$median_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,50), ylim = c(0,50))
abline(a = 0, b = 1)
qqplot(x=  u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42),
main = "cycle length variability",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
qqplot(x=  log10(u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")]),
y = log10(u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")]),
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,10), ylim = c(0,10),
main = "cycle length variability",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
qqplot(x=  log10(u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")]),
y = log10(u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")]),
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,3), ylim = c(0,3),
main = "cycle length variability",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
qqplot(x=  u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42),
main = "cycle length variability",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4,
data = u,
family = "binomial")
load(file = paste0(IO$output_data,"users.Rdata"), verbose = TRUE)
users$any_PL = ifelse(users$n_PL>0, "Yes", ifelse(users$n_LB>0,"No",NA))
u = users[which(!is.na(users$first_preg_outcome_simple)),]
u$is_first_preg_a_PL = (u$first_preg_outcome_simple == "PL")
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4,
data = u,
family = "binomial")
summary(glm_cl)
u$is_first_preg_a_PL = ifelse(u$is_first_preg_a_PL,"Yes","No")
g = ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(14,70))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("median cycle length before first positive preg. test")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "median_cycle_length_before_first_preg.pdf"), g, width = 5, height = 5)
g = ggplot(u, aes(x = sd_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 0.5)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(0,42))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("standard deviation in cycle length before 1st pos. preg. test")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "sd_cycle_length_before_first_preg.pdf"), g, width = 5, height = 5)
qqplot(x=  u$median_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$median_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,50), ylim = c(0,50))
abline(a = 0, b = 1)
qqplot(x=  u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "Yes")],
y = u$sd_cycle_length_4[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42),
main = "cycle length variability",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
g = ggplot(u, aes(x = log10(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 0.5)+
scale_x_continuous(breaks = log10(viz$xaxis_j))+ # , limits = c(0,42)
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("standard deviation (log10) in cycle length before 1st pos. preg. test")+
theme(legend.position = "top")
g
g = ggplot(u, aes(x = log10(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 0.1)+
#scale_x_continuous(breaks = log10(viz$xaxis_j))+ # , limits = c(0,42)
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("standard deviation (log10) in cycle length before 1st pos. preg. test")+
theme(legend.position = "top")
g
g = ggplot(u, aes(x = log10(sd_cycle_length_4), fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 0.1)+
#scale_x_continuous(breaks = log10(viz$xaxis_j))+ # , limits = c(0,42)
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("standard deviation (log10) in cycle length before 1st pos. preg. test")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "log10_sd_cycle_length_before_first_preg.pdf"), g, width = 5, height = 5)
g = ggplot(u, aes(x = median_cycle_length_4, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(14,70))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("median cycle length before first positive preg. test")+
theme(legend.position = "top")
g
colnames(u)
g = ggplot(u, aes(x = first_cycle_preg-1, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 0.5)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(0,42))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of cycles before getting pregnant")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "number_of_cycles_before_first_preg.pdf"), g, width = 5, height = 5)
g = ggplot(u, aes(x = first_cycle_preg-1, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_x_continuous(breaks = viz$xaxis_j, limits = c(0,42))+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of cycles before getting pregnant")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "number_of_cycles_before_first_preg.pdf"), g, width = 5, height = 5)
g = ggplot(u, aes(x = first_cycle_preg-1, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of cycles before getting pregnant")+
theme(legend.position = "top")
g
qqplot(x=  u$first_cycle_preg[which(u$is_first_preg_a_PL == "Yes")],
y = u$first_cycle_preg[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,42), ylim = c(0,42),
main = "# of cycles before getting pregnant",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
g
qqplot(x=  u$first_cycle_preg[which(u$is_first_preg_a_PL == "Yes")],
y = u$first_cycle_preg[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,80), ylim = c(0,80),
main = "# of cycles before getting pregnant",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4+
first_cycle_preg,
data = u,
family = "binomial")
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4+
first_cycle_preg,
data = u,
family = "binomial")
load(file = paste0(IO$output_data,"users.Rdata"), verbose = TRUE)
users$any_PL = ifelse(users$n_PL>0, "Yes", ifelse(users$n_LB>0,"No",NA))
u = users[which(!is.na(users$first_preg_outcome_simple)),]
u$is_first_preg_a_PL = (u$first_preg_outcome_simple == "PL")
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4+
first_cycle_preg,
data = u,
family = "binomial")
summary(glm_cl)
glm_cl = glm(
is_first_preg_a_PL ~ first_cycle_preg,
data = u,
family = "binomial")
summary(glm_cl)
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4+
first_cycle_preg,
data = u,
family = "binomial")
summary(glm_cl)
glm_cl = glm(
is_first_preg_a_PL ~ first_cycle_preg,
data = u,
family = "binomial")
summary(glm_cl)
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4+
first_cycle_preg,
data = u,
family = "binomial")
summary(glm_cl)
g = ggplot(u, aes(x = first_cycle_preg-1, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of cycles before getting pregnant")+
theme(legend.position = "top")
g
?glm
?ddplyr
?pply
?`dplyr-package`
head(cycles)
users_date_first_preg_test = cycles[which(cycles$cycle_nb == cycles$cycle_nb_first_pos_preg_test),c("user_id","cycle_start")]
colnames(cycles)
users_date_first_preg_test = cycles[which(cycles$cycle_nb == cycles$cycle_nb_first_pos_preg_test),c("user_id","start_date")]
users$time_to_first_pos_test = as.numeric(
users_date_first_preg_test$start_date[match(users$user_id,users_date_first_preg_test$user_id )] -
users$earliest_date)
hist(users$time_to_first_pos_test)
users$time_to_first_pos_test = users$time_to_first_pos_test_in_days /365
users$time_to_first_pos_test_in_days = as.numeric(
users_date_first_preg_test$start_date[match(users$user_id,users_date_first_preg_test$user_id )] -
users$earliest_date)
users$time_to_first_pos_test = users$time_to_first_pos_test_in_days /365
save(users, file = paste0(IO$output_data,"users.Rdata"))
file.copy(from = paste0(IO$output_data,"users.Rdata"), to = paste0(IO$tmp_data,"users_with_stats_4_cycles.Rdata"), overwrite = TRUE)
u = users[which(!is.na(users$first_preg_outcome_simple)),]
u$is_first_preg_a_PL = (u$first_preg_outcome_simple == "PL")
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4+
time_to_first_pos_test,
data = u,
family = "binomial")
summary(glm_cl)
g = ggplot(u, aes(x = time_to_first_pos_test, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of years before 1st positive preg. test")+
theme(legend.position = "top")
g
g = ggplot(u, aes(x = time_to_first_pos_test, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1/12)+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of years before 1st positive preg. test")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "time_before_first_preg.pdf"), g, width = 5, height = 5)
qqplot(x=  u$time_to_first_pos_test[which(u$is_first_preg_a_PL == "Yes")],
y = u$time_to_first_pos_test[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,5), ylim = c(0,5),
main = "# of cycles before getting pregnant",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
u$is_first_preg_a_PL = ifelse(u$is_first_preg_a_PL,"Yes","No")
g = ggplot(u, aes(x = first_cycle_preg-1, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1)+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of cycles before getting pregnant")+
theme(legend.position = "top")
g
g = ggplot(u, aes(x = time_to_first_pos_test, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1/12)+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of years before 1st positive preg. test")+
theme(legend.position = "top")
g
qqplot(x=  u$time_to_first_pos_test[which(u$is_first_preg_a_PL == "Yes")],
y = u$time_to_first_pos_test[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,5), ylim = c(0,5),
main = "# of cycles before getting pregnant",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
qqplot(x=  u$time_to_first_pos_test[which(u$is_first_preg_a_PL == "Yes")],
y = u$time_to_first_pos_test[which(u$is_first_preg_a_PL == "No")],
pch = 16, cex = 0.5, col = rgb(0,0,0,0.3),
xlim = c(0,5), ylim = c(0,5),
main = "time before getting pregnant",
xlab = "1st preg. ends up in a PL", ylab = "1st preg. ends up in a LB")
abline(a = 0, b = 1)
g = ggplot(u, aes(x = time_to_first_pos_test, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1/12)+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of years before 1st positive preg. test")+
theme(legend.position = "top")
g
ggsave(filename = paste0(IO$panels, "time_before_first_preg.pdf"), g, width = 5, height = 5)
g = ggplot(u, aes(x = time_to_first_pos_test, fill = is_first_preg_a_PL))+
geom_histogram(aes(y = ..density..), col = NA, alpha = 0.3, position = "identity", binwidth = 1/12)+
scale_fill_manual(name = "Does 1st pregnancy end up in a preg. loss?", values = c("blue","red"))+
xlab("# of years before 1st positive preg. test")+
theme(legend.position = "top")
g
u = users[which(!is.na(users$first_preg_outcome_simple)),]
u$is_first_preg_a_PL = (u$first_preg_outcome_simple == "PL")
glm_cl = glm(
is_first_preg_a_PL ~
sd_cycle_length_4+
median_cycle_length_4+
time_to_first_pos_test,
data = u,
family = "binomial")
summary(glm_cl)
